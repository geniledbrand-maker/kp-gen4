<?php
/**
 * ‚úÖ –¢–ï–°–¢ –ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–û–ì–û –ú–ê–°–®–¢–ê–ë–ò–†–û–í–ê–ù–ò–Ø –ò–ó–û–ë–†–ê–ñ–ï–ù–ò–ô
 * –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–æ–≤—É—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫–∏ –±–æ–ª—å—à–∏—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
 */

require_once 'classes/ExcelGenerator.php';

echo "<h2>üß™ –¢–µ—Å—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π</h2>";

// –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ —Å —Ä–∞–∑–Ω—ã–º–∏ —Ä–∞–∑–º–µ—Ä–∞–º–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
$testProducts = [
    [
        'name' => '–¢–æ–≤–∞—Ä —Å –º–∞–ª–µ–Ω—å–∫–∏–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º',
        'article' => 'TEST001',
        'price' => 1000,
        'base_price' => 1200,
        'discount_percent' => 16.67,
        'quantity' => 1,
        'image' => 'https://via.placeholder.com/50x50/FF0000/FFFFFF?text=SMALL'
    ],
    [
        'name' => '–¢–æ–≤–∞—Ä —Å–æ —Å—Ä–µ–¥–Ω–∏–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º',
        'article' => 'TEST002', 
        'price' => 2000,
        'base_price' => 2500,
        'discount_percent' => 20,
        'quantity' => 2,
        'image' => 'https://via.placeholder.com/200x200/00FF00/FFFFFF?text=MEDIUM'
    ],
    [
        'name' => '–¢–æ–≤–∞—Ä —Å –±–æ–ª—å—à–∏–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º',
        'article' => 'TEST003',
        'price' => 3000,
        'base_price' => 4000,
        'discount_percent' => 25,
        'quantity' => 1,
        'image' => 'https://via.placeholder.com/800x600/0000FF/FFFFFF?text=LARGE'
    ],
    [
        'name' => '–¢–æ–≤–∞—Ä —Å –æ—á–µ–Ω—å –±–æ–ª—å—à–∏–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º',
        'article' => 'TEST004',
        'price' => 4000,
        'base_price' => 5000,
        'discount_percent' => 20,
        'quantity' => 1,
        'image' => 'https://via.placeholder.com/1200x800/FF00FF/FFFFFF?text=HUGE'
    ],
    [
        'name' => '–¢–æ–≤–∞—Ä –±–µ–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è',
        'article' => 'TEST005',
        'price' => 5000,
        'base_price' => 6000,
        'discount_percent' => 16.67,
        'quantity' => 1,
        'image' => ''
    ]
];

echo "<h3>üìä –¢–µ—Å—Ç–æ–≤—ã–µ —Ç–æ–≤–∞—Ä—ã:</h3>";
echo "<ul>";
foreach ($testProducts as $product) {
    $imageInfo = $product['image'] ? "‚úÖ –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ: {$product['image']}" : "‚ùå –ë–µ–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è";
    echo "<li><strong>{$product['name']}</strong> - {$imageInfo}</li>";
}
echo "</ul>";

try {
    echo "<h3>üîß –°–æ–∑–¥–∞–Ω–∏–µ Excel —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ–º...</h3>";
    
    $generator = new ExcelGenerator();
    
    // –î–æ–±–∞–≤–ª—è–µ–º —Ç–æ–≤–∞—Ä—ã
    foreach ($testProducts as $product) {
        $generator->addProduct($product);
    }
    
    // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º Excel
    $filename = 'test_image_scaling_' . date('Y-m-d_H-i-s') . '.xlsx';
    $filepath = $generator->generate($filename);
    
    if ($filepath && file_exists($filepath)) {
        $fileSize = filesize($filepath);
        echo "<div style='background: #d4edda; padding: 15px; border-radius: 5px; margin: 10px 0;'>";
        echo "<h4>‚úÖ Excel —Ñ–∞–π–ª —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω!</h4>";
        echo "<p><strong>–§–∞–π–ª:</strong> {$filename}</p>";
        echo "<p><strong>–†–∞–∑–º–µ—Ä:</strong> " . number_format($fileSize / 1024, 2) . " KB</p>";
        echo "<p><strong>–ü—É—Ç—å:</strong> {$filepath}</p>";
        echo "</div>";
        
        echo "<h4>üéØ –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:</h4>";
        echo "<ul>";
        echo "<li><strong>–ú–∞–ª–µ–Ω—å–∫–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ (50x50):</strong> –î–æ–ª–∂–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –≤ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–º —Ä–∞–∑–º–µ—Ä–µ</li>";
        echo "<li><strong>–°—Ä–µ–¥–Ω–µ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ (200x200):</strong> –î–æ–ª–∂–Ω–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞—Ç—å—Å—è –¥–æ 90x90 –ø–∏–∫—Å–µ–ª–µ–π</li>";
        echo "<li><strong>–ë–æ–ª—å—à–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ (800x600):</strong> –î–æ–ª–∂–Ω–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞—Ç—å—Å—è –¥–æ 90x68 –ø–∏–∫—Å–µ–ª–µ–π</li>";
        echo "<li><strong>–û—á–µ–Ω—å –±–æ–ª—å—à–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ (1200x800):</strong> –î–æ–ª–∂–Ω–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞—Ç—å—Å—è –¥–æ 90x60 –ø–∏–∫—Å–µ–ª–µ–π</li>";
        echo "<li><strong>–¢–æ–≤–∞—Ä –±–µ–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è:</strong> –°—Ç—Ä–æ–∫–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –æ–±—ã—á–Ω–æ–π –≤—ã—Å–æ—Ç—ã (100px)</li>";
        echo "<li><strong>–¢–æ–≤–∞—Ä—ã —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏:</strong> –°—Ç—Ä–æ–∫–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —É–≤–µ–ª–∏—á–µ–Ω–Ω–æ–π –≤—ã—Å–æ—Ç—ã (120px)</li>";
        echo "</ul>";
        
        echo "<h4>üìã –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤ Excel:</h4>";
        echo "<ol>";
        echo "<li>–û—Ç–∫—Ä–æ–π—Ç–µ —Å–æ–∑–¥–∞–Ω–Ω—ã–π —Ñ–∞–π–ª</li>";
        echo "<li>–ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤—Å–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø–æ–º–µ—â–∞—é—Ç—Å—è –≤ —è—á–µ–π–∫–∏</li>";
        echo "<li>–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã –≤ —è—á–µ–π–∫–∞—Ö</li>";
        echo "<li>–ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤—ã—Å–æ—Ç–∞ —Å—Ç—Ä–æ–∫ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –Ω–∞–ª–∏—á–∏—é –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π</li>";
        echo "<li>–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Å–∫–∏–¥–∫–∏ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ</li>";
        echo "</ol>";
        
    } else {
        echo "<div style='background: #f8d7da; padding: 15px; border-radius: 5px; margin: 10px 0;'>";
        echo "<h4>‚ùå –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è Excel —Ñ–∞–π–ª–∞</h4>";
        echo "<p>–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª –∏–ª–∏ —Ñ–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω</p>";
        echo "</div>";
    }
    
} catch (Exception $e) {
    echo "<div style='background: #f8d7da; padding: 15px; border-radius: 5px; margin: 10px 0;'>";
    echo "<h4>‚ùå –û—à–∏–±–∫–∞:</h4>";
    echo "<p>" . htmlspecialchars($e->getMessage()) . "</p>";
    echo "</div>";
}

echo "<h3>üìù –õ–æ–≥–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π:</h3>";
echo "<p>–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤ —Ñ–∞–π–ª–µ error_log –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ:</p>";
echo "<ul>";
echo "<li>–ó–∞–≥—Ä—É–∑–∫–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π</li>";
echo "<li>–°–æ–∑–¥–∞–Ω–∏–∏ –º–∏–Ω–∏–∞—Ç—é—Ä –¥–ª—è –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤</li>";
echo "<li>–ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π</li>";
echo "<li>–¶–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–∏ –≤ —è—á–µ–π–∫–∞—Ö</li>";
echo "</ul>";

echo "<hr>";
echo "<p><em>–¢–µ—Å—Ç –∑–∞–≤–µ—Ä—à–µ–Ω. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–æ–∑–¥–∞–Ω–Ω—ã–π Excel —Ñ–∞–π–ª –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –æ–∂–∏–¥–∞–µ–º—ã–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º.</em></p>";
?>
