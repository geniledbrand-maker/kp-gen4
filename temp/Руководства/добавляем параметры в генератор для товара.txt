# üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–∏—Å—Ç–µ–º—ã —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

## üì¶ –§–∞–π–ª—ã –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

### 1. `config/constants.php`
- –ê—Ä—Ç–µ—Ñ–∞–∫—Ç: `constants_full`
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã –≤—Å–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
- ‚úÖ –°–æ–∑–¥–∞–Ω–∞ –∫–∞—Ä—Ç–∞ `PRODUCT_PROPS_MAP`
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

### 2. `includes/helpers.php`
- –ê—Ä—Ç–µ—Ñ–∞–∫—Ç: `helpers_get_params`
- ‚úÖ –§—É–Ω–∫—Ü–∏—è `getProductParams()` - –ø–æ–ª—É—á–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- ‚úÖ –§—É–Ω–∫—Ü–∏—è `formatParamsForJson()` - —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è JSON
- ‚úÖ –§—É–Ω–∫—Ü–∏—è `getPropertyValue()` - –ø–æ–ª—É—á–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è —Å–≤–æ–π—Å—Ç–≤–∞

### 3. `assets/js/ui.js`
- **–£–ñ–ï –û–ë–ù–û–í–õ–ï–ù** –≤ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–µ `ui_js_final`
- ‚úÖ –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–æ–≤–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞ `propsDetails`
- ‚úÖ –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å–æ —Å—Ç–∞—Ä—ã–º —Ñ–æ—Ä–º–∞—Ç–æ–º

### 4. `includes/ajax_handler.php`
- –ê—Ä—Ç–µ—Ñ–∞–∫—Ç: `ajax_handler_example` (–ø—Ä–∏–º–µ—Ä)
- ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `getProductParams()`
- ‚úÖ –û—Ç–ø—Ä–∞–≤–∫–∞ `props` –∏ `propsDetails`

---

## üîß –ü–æ—à–∞–≥–æ–≤–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞

### –®–∞–≥ 1: –û–±–Ω–æ–≤–∏—Ç–µ constants.php

```bash
# –ó–∞–º–µ–Ω–∏—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞
/local/tools/kp_gen4/config/constants.php
```

–°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∏–∑ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–∞: `constants_full`

### –®–∞–≥ 2: –û–±–Ω–æ–≤–∏—Ç–µ –∏–ª–∏ —Å–æ–∑–¥–∞–π—Ç–µ helpers.php

```bash
# –ï—Å–ª–∏ —Ñ–∞–π–ª —Å—É—â–µ—Å—Ç–≤—É–µ—Ç - –¥–æ–±–∞–≤—å—Ç–µ —Ñ—É–Ω–∫—Ü–∏–∏
# –ï—Å–ª–∏ –Ω–µ—Ç - —Å–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π
/local/tools/kp_gen4/includes/helpers.php
```

–°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∏–∑ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–∞: `helpers_get_params`

### –®–∞–≥ 3: –û–±–Ω–æ–≤–∏—Ç–µ ajax_handler.php

–ù–∞–π–¥–∏—Ç–µ –≤ —Ñ–∞–π–ª–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ `get_product` –∏ –∑–∞–º–µ–Ω–∏—Ç–µ –µ–≥–æ –Ω–∞:

```php
if ($action === 'get_product') {
    // ... –ø–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ ...

    // ‚úÖ –î–û–ë–ê–í–¨–¢–ï –≠–¢–ò –°–¢–†–û–ö–ò:
    $productParams = getProductParams(['PROPERTIES' => $props]);

    $response = [
        'success' => true,
        'data' => [
            // ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø–æ–ª—è ...
            'props' => formatParamsForJson($productParams),  // –°—Ç–∞—Ä—ã–π —Ñ–æ—Ä–º–∞—Ç
            'propsDetails' => $productParams                  // –ù–æ–≤—ã–π —Ñ–æ—Ä–º–∞—Ç
        ]
    ];
}
```

–ü–æ–ª–Ω—ã–π –ø—Ä–∏–º–µ—Ä –≤ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–µ: `ajax_handler_example`

### –®–∞–≥ 4: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ ui.js

–§–∞–π–ª `ui.js` —É–∂–µ –æ–±–Ω–æ–≤–ª–µ–Ω –≤ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–µ `ui_js_final`.

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è `renderProductInfo` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –Ω–æ–≤—ã–π —Ñ–æ—Ä–º–∞—Ç:

```javascript
if (propsDetails && Object.keys(propsDetails).length > 0) {
    // –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤—Å–µ—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
    Object.entries(propsDetails).forEach(([key, data]) => {
        // ...
    });
}
```

### –®–∞–≥ 5: –û—á–∏—Å—Ç–∏—Ç–µ –∫—ç—à

```bash
# –ë—Ä–∞—É–∑–µ—Ä
Ctrl + Shift + R

# –ë–∏—Ç—Ä–∏–∫—Å (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)
/bitrix/admin/cache.php
```

---

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

### 1. –û—Ç–∫—Ä–æ–π—Ç–µ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä –ö–ü

### 2. –î–æ–±–∞–≤—å—Ç–µ —Ç–æ–≤–∞—Ä

–í–≤–µ–¥–∏—Ç–µ –∞—Ä—Ç–∏–∫—É–ª –∏ –Ω–∞–∂–º–∏—Ç–µ "–î–æ–±–∞–≤–∏—Ç—å"

### 3. –û—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–Ω—Å–æ–ª—å (F12) ‚Üí Network

–ù–∞–π–¥–∏—Ç–µ –∑–∞–ø—Ä–æ—Å `get_product` –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –æ—Ç–≤–µ—Ç:

```json
{
  "success": true,
  "data": {
    "id": 123,
    "name": "–°–≤–µ—Ç–∏–ª—å–Ω–∏–∫",
    "props": {
      "ct": "4000",
      "pwr": "60",
      "ip": "IP66",
      "lumen": "7200",
      "efficiency": "120"
    },
    "propsDetails": {
      "ct": {
        "value": "4000",
        "label": "–¶–≤–µ—Ç–æ–≤–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞, –ö",
        "order": 1,
        "required": true
      }
    }
  }
}
```

### 4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤ —Ç–∞–±–ª–∏—Ü–µ

–î–æ–ª–∂–Ω—ã –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –í–°–ï –ø–∞—Ä–∞–º–µ—Ç—Ä—ã, —É –∫–æ—Ç–æ—Ä—ã—Ö –µ—Å—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è:

```
–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
–¶–≤–µ—Ç–æ–≤–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞, –ö:    4000
–≠–ª–µ–∫—Ç—Ä–æ–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ, –í—Ç:     60
–°—Ç–µ–ø–µ–Ω—å –ø—ã–ª–µ–≤–ª–∞–≥–æ–∑–∞—â–∏—Ç—ã:    IP66
–ò–Ω–¥–µ–∫—Å —Ü–≤–µ—Ç–æ–ø–µ—Ä–µ–¥–∞—á–∏, Ra:   82
–°–≤–µ—Ç–æ–≤–æ–π –ø–æ—Ç–æ–∫, –õ–º:         7200
–≠–Ω–µ—Ä–≥–æ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å, –ª–º/–í—Ç: 120
–£–≥–æ–ª —Ä–∞—Å—Å–µ–∏–≤–∞–Ω–∏—è, ¬∞:        120
–ú–∞—Ç–µ—Ä–∏–∞–ª –∫–æ—Ä–ø—É—Å–∞:           –ê–ª—é–º–∏–Ω–∏–π
–ì–∞—Ä–∞–Ω—Ç–∏—è, –ª–µ—Ç:              3
```

### 5. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Å—ã–ª–∫–∏

–ö–ª–∏–∫–Ω–∏—Ç–µ –Ω–∞ –ª—é–±–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞:
- –î–æ–ª–∂–Ω–∞ –æ—Ç–∫—Ä—ã—Ç—å—Å—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –∫–∞—Ç–∞–ª–æ–≥–∞
- –° –ø—Ä–∏–º–µ–Ω–µ–Ω–Ω—ã–º —Ñ–∏–ª—å—Ç—Ä–æ–º –ø–æ —ç—Ç–æ–º—É –ø–∞—Ä–∞–º–µ—Ç—Ä—É

---

## üéØ –ß—Ç–æ –¥–µ–ª–∞—Ç—å –¥–∞–ª—å—à–µ

### –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä

1. –û—Ç–∫—Ä–æ–π—Ç–µ `config/constants.php`
2. –î–æ–±–∞–≤—å—Ç–µ `define('PROP_XXX_LIST', [ID])`
3. –î–æ–±–∞–≤—å—Ç–µ –≤ `PRODUCT_PROPS_MAP`
4. –ì–æ—Ç–æ–≤–æ!

### –ò–∑–º–µ–Ω–∏—Ç—å –ø–æ—Ä—è–¥–æ–∫ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

–ò–∑–º–µ–Ω–∏—Ç–µ –∑–Ω–∞—á–µ–Ω–∏–µ `order` –≤ `PRODUCT_PROPS_MAP`:

```php
'ct' => [
    // ...
    'order' => 1  // –ë—É–¥–µ—Ç –ø–µ—Ä–≤—ã–º
],
'pwr' => [
    // ...
    'order' => 2  // –ë—É–¥–µ—Ç –≤—Ç–æ—Ä—ã–º
]
```

### –°–¥–µ–ª–∞—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–º

–ò–∑–º–µ–Ω–∏—Ç–µ `required` –Ω–∞ `true`:

```php
'lumen' => [
    // ...
    'required' => true  // –ë—É–¥–µ—Ç –≤—ã–¥–µ–ª–µ–Ω –∫–∞–∫ –≤–∞–∂–Ω—ã–π
]
```

---

## üêõ –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –ü–∞—Ä–∞–º–µ—Ç—Ä –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è

**–ü—Ä–æ–±–ª–µ–º–∞:** –î–æ–±–∞–≤–∏–ª –ø–∞—Ä–∞–º–µ—Ç—Ä, –Ω–æ –æ–Ω –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ ID —Å–≤–æ–π—Å—Ç–≤–∞ –≤ –ë–∏—Ç—Ä–∏–∫—Å
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É —Ç–æ–≤–∞—Ä–∞ –∑–∞–ø–æ–ª–Ω–µ–Ω–æ —ç—Ç–æ —Å–≤–æ–π—Å—Ç–≤–æ
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ `helpers.php` –ø–æ–¥–∫–ª—é—á–µ–Ω
4. –û—á–∏—Å—Ç–∏—Ç–µ –∫—ç—à

### –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

**–ü—Ä–æ–±–ª–µ–º–∞:** –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –Ω–µ –≤ —Ç–æ–º –ø–æ—Ä—è–¥–∫–µ

**–†–µ—à–µ–Ω–∏–µ:**
–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∑–Ω–∞—á–µ–Ω–∏—è `order` –≤ `PRODUCT_PROPS_MAP` - –æ–Ω–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º–∏ –∏ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–º–∏.

### –û—à–∏–±–∫–∞ "Call to undefined function getProductParams()"

**–ü—Ä–æ–±–ª–µ–º–∞:** –§—É–Ω–∫—Ü–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω–∞

**–†–µ—à–µ–Ω–∏–µ:**
–ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤ –Ω–∞—á–∞–ª–µ `ajax_handler.php` –µ—Å—Ç—å:

```php
require_once __DIR__ . '/helpers.php';
```

---

## üìã –ö–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–π —Å–ø–∏—Å–æ–∫ —É—Å—Ç–∞–Ω–æ–≤–∫–∏

- [ ] –û–±–Ω–æ–≤–∏–ª `config/constants.php`
- [ ] –û–±–Ω–æ–≤–∏–ª/—Å–æ–∑–¥–∞–ª `includes/helpers.php`
- [ ] –û–±–Ω–æ–≤–∏–ª `includes/ajax_handler.php`
- [ ] –ü—Ä–æ–≤–µ—Ä–∏–ª `assets/js/ui.js` (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∏–∑ `ui_js_final`)
- [ ] –û—á–∏—Å—Ç–∏–ª –∫—ç—à –±—Ä–∞—É–∑–µ—Ä–∞
- [ ] –ü—Ä–æ–≤–µ—Ä–∏–ª –æ—Ç–≤–µ—Ç —Å–µ—Ä–≤–µ—Ä–∞ –≤ Network
- [ ] –ü—Ä–æ–≤–µ—Ä–∏–ª –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –≤ —Ç–∞–±–ª–∏—Ü–µ
- [ ] –ü—Ä–æ–≤–µ—Ä–∏–ª —Ä–∞–±–æ—Ç—É —Å—Å—ã–ª–æ–∫ –Ω–∞ –∫–∞—Ç–∞–ª–æ–≥
- [ ] –î–æ–±–∞–≤–∏–ª —Ç–µ—Å—Ç–æ–≤—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏

---

## üéâ –ì–æ—Ç–æ–≤–æ!

–¢–µ–ø–µ—Ä—å —É –≤–∞—Å:
- ‚úÖ –í—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ç–æ–≤–∞—Ä–æ–≤ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- ‚úÖ –õ–µ–≥–∫–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
- ‚úÖ –ö–ª–∏–∫–∞–±–µ–ª—å–Ω—ã–µ —Å—Å—ã–ª–∫–∏ –Ω–∞ –∫–∞—Ç–∞–ª–æ–≥
- ‚úÖ –ì–∏–±–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —á–µ—Ä–µ–∑ constants.php
- ‚úÖ –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å–æ —Å—Ç–∞—Ä—ã–º –∫–æ–¥–æ–º

–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é! üöÄ